def merge_intervals(intervals):
    merged = []
    for interval in sorted(intervals, key=lambda x: x[0]):
        if not merged or merged[-1][1] < interval[0]:
            merged.append(interval)
        else:
            merged[-1] = (merged[-1][0], max(merged[-1][1], interval[1]))
    return merged

def find_free_slots(busy_slots):
    # Merge busy slots and sort by start time
    merged_busy_slots = merge_intervals(busy_slots)

    # Find gaps (free time slots)
    free_slots = []
    last_end = 0
    for start, end in merged_busy_slots:
        if start > last_end:
            free_slots.append((last_end, start))
        last_end = max(last_end, end)

    # Check if there's a gap after the last busy slot
    if last_end < 1440:  # Assuming a day has 1440 minutes (24 hours)
        free_slots.append((last_end, 1440))

    return free_slots

def find_common_free_time(busy_times):
    # Get busy slots for each individual
    busy_slots = [merge_intervals(times) for times in busy_times]

    # Find common free time slots
    common_free_slots = find_free_slots(busy_slots)

    # Check common free slots against each individual's busy schedule
    for start, end in common_free_slots:
        is_common_free = True
        for slots in busy_slots:
            if any(s_start <= start < s_end or s_start < end <= s_end for s_start, s_end in slots):
                is_common_free = False
                break
        if is_common_free:
            return start, end

    return None

# Example usage
if __name__ == "__main__":
    # Busy times for individuals (in minutes)
    individual_busy_times = [
        [(30, 120), (180, 240)],  # Individual 1
        [(0, 60), (150, 210)],    # Individual 2
        [(90, 150), (200, 270)]   # Individual 3
    ]

    # Find common free time slot
    common_free_time = find_common_free_time(individual_busy_times)
    if common_free_time:
        start, end = common_free_time
        print(f"Common free time slot found: {start} minutes to {end} minutes")
    else:
        print("No common free time slot found")
